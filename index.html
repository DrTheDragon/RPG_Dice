<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Test RPG</title>

<link rel="icon" type="image/png" href="data:image/svg+xml,
<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'>
<polygon points='50,5 95,30 80,90 20,90 5,30' fill='black'/>
<text x='50' y='65' font-size='40' fill='white' text-anchor='middle'>20</text>
</svg>">

<style>
:root{
  --bg:#0b0b0b;
  --panel:#111;
  --text:#e5e5e5;
  --muted:#777;
  --accent:#8b0000;
}

body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:'Courier New', monospace;
}

h2,h3{
  margin:6px 0;
}

.container{
  display:flex;
  gap:10px;
  padding:10px;
}

.left,.right{
  flex:1;
  background:var(--panel);
  padding:10px;
  border-radius:8px;
}

input,textarea,button{
  width:100%;
  background:#0e0e0e;
  border:1px solid #222;
  color:var(--text);
  padding:6px;
  border-radius:5px;
  margin-top:4px;
}

textarea{resize:none;}

button{
  cursor:pointer;
  transition:transform .1s;
}

button:active{
  transform:scale(0.97);
}

.dado{
  font-size:42px;
  text-align:center;
  margin:10px 0;
}

.roll{animation:spin .25s linear;}

@keyframes spin{
  from{transform:rotate(0deg);}
  to{transform:rotate(360deg);}
}

.result{
  text-align:center;
  font-size:18px;
  margin-top:4px;
}

.hist div{
  font-size:12px;
  margin-top:2px;
}

.fade1{color:#aaa;}
.fade2{color:#777;}
.fade3{color:#444;}

.checks{
  display:flex;
  gap:6px;
  margin-top:6px;
}

.smallbtns{
  display:flex;
  gap:4px;
}

hr{
  border:0;
  border-top:1px solid #222;
  margin:10px 0;
}
</style>
</head>

<body>

<audio id="diceSound">
  <source src="https://cdn.pixabay.com/audio/2022/03/15/audio_1c3b04bb7c.mp3">
</audio>

<div style="padding:10px">
  <input id="charName" placeholder="Nome do Personagem">
</div>

<div class="container">

<div class="left">
<h2>Testes</h2>

<input id="attr" type="number" placeholder="Valor do atributo">
<button onclick="rollAttr()">Rolar Atributo</button>

<div class="dado" id="dice">ðŸŽ²</div>
<div class="result" id="result"></div>

<h3>HistÃ³rico</h3>
<div class="hist" id="hist"></div>

<hr>

<h3>Teste de Sanidade</h3>
<button onclick="rollSan()">Rolar Sanidade</button>
<div class="result" id="sanResult"></div>

</div>

<div class="right">
<h2>Status</h2>

<input id="vidaMax" type="number" placeholder="Vida MÃ¡xima">
<input id="vida" type="number" placeholder="Vida Atual">

<div class="checks">
<label><input type="checkbox"> Chance</label>
<label><input type="checkbox"> Chance</label>
<label><input type="checkbox"> Chance</label>
</div>

<label><input type="checkbox"> Extremamente Ferido</label><br>
<label><input type="checkbox"> CaÃ­do</label>

<hr>

<input id="sanMax" type="number" placeholder="Sanidade MÃ¡xima">
<input id="san" type="number" placeholder="Sanidade Atual">

<hr>

<h3>Sono (horas)</h3>
<input id="sono" type="number">
<div class="smallbtns">
<button onclick="adj('sono',1)">+1</button>
<button onclick="adj('sono',3)">+3</button>
<button onclick="adj('sono',-1)">-1</button>
<button onclick="adj('sono',-3)">-3</button>
</div>

<hr>

<input id="money" placeholder="Dinheiro">

<hr>

<textarea id="vantagens" placeholder="Vantagens"></textarea>
<textarea id="traumas" placeholder="Traumas"></textarea>
<textarea id="itens" placeholder="Itens / AcessÃ³rios"></textarea>

</div>
</div>

<script>
const dice=document.getElementById("dice");
const sound=document.getElementById("diceSound");
const histEl=document.getElementById("hist");

let history=JSON.parse(localStorage.getItem("hist"))||[];

function saveLS(){
  localStorage.setItem("hist",JSON.stringify(history));
  localStorage.setItem("money",money.value);
  localStorage.setItem("vantagens",vantagens.value);
  localStorage.setItem("traumas",traumas.value);
  localStorage.setItem("itens",itens.value);
  localStorage.setItem("charName",charName.value);
  localStorage.setItem("vidaMax",vidaMax.value);
  localStorage.setItem("sanMax",sanMax.value);
}

function loadLS(){
  money.value=localStorage.getItem("money")||"";
  vantagens.value=localStorage.getItem("vantagens")||"";
  traumas.value=localStorage.getItem("traumas")||"";
  itens.value=localStorage.getItem("itens")||"";
  charName.value=localStorage.getItem("charName")||"";
  vidaMax.value=localStorage.getItem("vidaMax")||"";
  sanMax.value=localStorage.getItem("sanMax")||"";
}
loadLS();

function animateDice(){
  dice.classList.add("roll");
  sound.currentTime=0;
  sound.play();
  setTimeout(()=>dice.classList.remove("roll"),250);
}

function rollD20(){
  return Math.min(20,Math.max(1,Math.floor(Math.random()*20)+1));
}

function rollAttr(){
  const attrVal=parseInt(attr.value);
  if(isNaN(attrVal)) return;

  animateDice();
  const d=rollD20();

  let res="Normal";
  if(d===1) res="Falha CrÃ­tica";
  else if(d===20) res="Sucesso CrÃ­tico";
  else if(d>=18) res="Bom";

  result.innerText=`D20: ${d} | Atributo: ${attrVal} â†’ ${res}`;

  history.unshift(`D20:${d} | ATR:${attrVal} | ${res}`);
  history=history.slice(0,6);
  renderHist();
  saveLS();
}

function renderHist(){
  histEl.innerHTML="";
  history.forEach((h,i)=>{
    const div=document.createElement("div");
    div.textContent=h;
    if(i>=3) div.className=["fade1","fade2","fade3"][i-3]||"fade3";
    histEl.appendChild(div);
  });
}

function rollSan(){
  const max=parseInt(sanMax.value);
  if(isNaN(max)) return;
  const d=Math.floor(Math.random()*100)+1;
  sanResult.innerText=`${d} vs ${max} â†’ ${d<=max?"Sucesso":"Falha"}`;
}

function adj(id,val){
  const el=document.getElementById(id);
  el.value=(parseInt(el.value)||0)+val;
  saveLS();
}

document.querySelectorAll("input,textarea").forEach(e=>{
  e.addEventListener("input",saveLS);
});

renderHist();
</script>

</body>
</html>
