<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Teste RPG â€¢ D20</title>

<!-- ÃCONE DE DADO -->
<link rel="icon" href="data:image/svg+xml,
<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'>
<polygon points='50,5 95,35 80,90 20,90 5,35'
fill='black'/>
<text x='50' y='65' font-size='40' text-anchor='middle' fill='white'>20</text>
</svg>">

<style>
:root{
  --bg:#0b0b0b;
  --fg:#e5e5e5;
  --box:#151515;
  --accent:#cfcfcf;
}
.light{
  --bg:#f2f2f2;
  --fg:#111;
  --box:#ffffff;
}
*{box-sizing:border-box;font-family:monospace;}
body{
  margin:0;
  background:var(--bg);
  color:var(--fg);
}
.container{
  max-width:900px;
  margin:auto;
  padding:15px;
}
header{
  display:flex;
  justify-content:space-between;
  align-items:center;
}
button{
  background:var(--box);
  color:var(--fg);
  border:1px solid #333;
  padding:8px 12px;
  cursor:pointer;
}
button:active{
  transform:scale(0.97);
}
.main{
  display:flex;
  gap:15px;
  margin-top:15px;
}
.left,.right{
  flex:1;
  background:var(--box);
  padding:12px;
}
.section{margin-bottom:15px;}
input{
  width:100%;
  background:#000;
  color:#fff;
  border:1px solid #444;
  padding:6px;
  margin-top:5px;
}
.dice{
  font-size:48px;
  text-align:center;
  margin:10px 0;
}
.roll{
  animation:roll 0.15s linear;
}
@keyframes roll{
  from{transform:rotate(0deg);}
  to{transform:rotate(15deg);}
}
.history div{
  padding:4px;
}
.fade1{opacity:.7}
.fade2{opacity:.45}
.fade3{opacity:.25}
textarea{
  width:100%;
  height:80px;
  background:#000;
  color:#fff;
  border:1px solid #444;
  padding:6px;
}
@media(max-width:700px){
  .main{flex-direction:column;}
}
</style>
</head>

<body>
<div class="container">
<header>
  <h2>Noir RPG â€¢ D20</h2>
  <button onclick="toggleTheme()">â˜¼ / â˜¾</button>
</header>

<div class="main">
<!-- ESQUERDA -->
<div class="left">
  <div class="section">
    <h3>Teste de Atributo</h3>
    <input id="attrName" placeholder="Nome do atributo">
    <input id="attrValue" type="number" placeholder="Valor do atributo">
    <button onclick="rollAttribute()">Rolar</button>
  </div>

  <div class="section">
    <h3>Teste de Sanidade</h3>
    <button onclick="rollSanity()">Rolar Sanidade</button>
  </div>

  <div class="section">
    <h3>HistÃ³rico</h3>
    <div id="history" class="history"></div>
  </div>
</div>

<!-- DIREITA -->
<div class="right">
  <div class="section">
    <h3>Vida</h3>
    MÃ¡x: <input id="vidaMax" type="number">
    Atual: <input id="vidaAtual" type="number">
  </div>

  <div class="section">
    <h3>Sanidade</h3>
    MÃ¡x: <input id="sanMax" type="number">
    Atual: <input id="sanAtual" type="number">
  </div>

  <div class="section">
    <h3>ðŸŽ²</h3>
    <div id="dice" class="dice">â€”</div>
  </div>

  <div class="section">
    <h3>Itens / AcessÃ³rios</h3>
    <textarea id="items"></textarea>
  </div>
</div>
</div>
</div>

<audio id="diceSound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_7c8c9d2d52.mp3"></audio>

<script>
const diceEl=document.getElementById("dice");
const historyEl=document.getElementById("history");
const sound=document.getElementById("diceSound");

let history=JSON.parse(localStorage.getItem("history"))||[];

function save(){
  localStorage.setItem("history",JSON.stringify(history));
  localStorage.setItem("items",items.value);
  localStorage.setItem("vidaMax",vidaMax.value);
  localStorage.setItem("vidaAtual",vidaAtual.value);
  localStorage.setItem("sanMax",sanMax.value);
  localStorage.setItem("sanAtual",sanAtual.value);
}

function load(){
  items.value=localStorage.getItem("items")||"";
  vidaMax.value=localStorage.getItem("vidaMax")||"";
  vidaAtual.value=localStorage.getItem("vidaAtual")||"";
  sanMax.value=localStorage.getItem("sanMax")||"";
  sanAtual.value=localStorage.getItem("sanAtual")||"";
  renderHistory();
}

function roll(){
  sound.currentTime=0;
  sound.play();
  diceEl.classList.add("roll");
  setTimeout(()=>diceEl.classList.remove("roll"),150);
  let n=Math.floor(Math.random()*20)+1;
  diceEl.textContent=n;
  return n;
}

function addHistory(text){
  history.unshift(text);
  if(history.length>6)history.pop();
  save();
  renderHistory();
}

function renderHistory(){
  historyEl.innerHTML="";
  history.forEach((h,i)=>{
    let d=document.createElement("div");
    d.textContent=h;
    if(i===3)d.className="fade1";
    if(i===4)d.className="fade2";
    if(i===5)d.className="fade3";
    historyEl.appendChild(d);
  });
}

function rollAttribute(){
  let name=attrName.value||"Atributo";
  let val=parseInt(attrValue.value)||0;
  let d=roll();
  if(val<=0){
    addHistory(`${name}: ${d}`);
    return;
  }
  let res=d<=val?"Sucesso":"Falha";
  addHistory(`${name} (${val}) â†’ ${d} = ${res}`);
}

function rollSanity(){
  let max=parseInt(sanMax.value)||0;
  let d=Math.floor(Math.random()*100)+1;
  diceEl.textContent=d;
  let res=d<=max?"Sucesso":"Falha";
  addHistory(`Sanidade (${max}) â†’ ${d} = ${res}`);
}

function toggleTheme(){
  document.body.classList.toggle("light");
}

["items","vidaMax","vidaAtual","sanMax","sanAtual"].forEach(id=>{
  document.getElementById(id).addEventListener("input",save);
});

load();
</script>
</body>
</html>
