<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Teste RPG Noir</title>
<link rel="icon" type="image/svg+xml" href="favicon.svg">
<link href="https://fonts.googleapis.com/css2?family=Special+Elite&display=swap" rel="stylesheet">

<style>
:root{
 --bg1:#111;--bg2:#000;--panel:#080808;--text:#e0e0e0;--border:#222;
}
body.light{
 --bg1:#e6e6e6;--bg2:#cfcfcf;--panel:#f5f5f5;--text:#111;--border:#bbb;
}

body{
 margin:0;
 min-height:100vh;
 background:radial-gradient(circle at top,var(--bg1),var(--bg2));
 color:var(--text);
 font-family:'Special Elite',monospace;
 display:flex;
 justify-content:center;
}

.wrapper{width:100%;max-width:900px;padding:15px}

.app{
 display:grid;
 grid-template-columns:1fr 1fr;
 gap:20px;
}

.panel{
 background:var(--panel);
 border:1px solid var(--border);
 padding:20px;
 box-shadow:0 0 40px rgba(0,0,0,.6);
}

h2,h3,h4{text-align:center;letter-spacing:2px}

.section{margin-top:15px;padding-top:10px;border-top:1px solid var(--border)}

input,button,textarea{
 width:100%;
 padding:10px;
 margin-top:8px;
 background:transparent;
 border:1px solid var(--border);
 color:var(--text);
 font-family:'Special Elite',monospace;
 text-align:center;
}

textarea{text-align:left;min-height:120px}

button{cursor:pointer}
button:hover{background:rgba(255,255,255,.05)}
button:active{transform:scale(.97)}

.controls{
 display:flex;
 gap:6px;
 flex-wrap:wrap;
}
.controls button{flex:1}

.dado{font-size:56px;text-align:center;margin:10px 0}
.resultado{text-align:center;min-height:80px}

.E{color:#ff4c4c}
.B{color:#4fa3ff}
.N{color:#9acd32}
.F{color:#777}

.historico ul{list-style:none;padding:0;margin:0}
.historico li{padding:6px;border-bottom:1px solid var(--border);font-size:14px}
.fade-0{color:var(--text)}
.fade-1{color:#aaa}
.fade-2{color:#888}
.fade-3{color:#666}

.toggle{text-align:right;margin-bottom:10px}

@media(max-width:768px){
 .app{grid-template-columns:1fr}
}
</style>
</head>

<body>
<div class="wrapper">

<div class="toggle">
<button onclick="toggleTema()">üåó Alternar Tema</button>
</div>

<div class="app">

<!-- ESQUERDA -->
<div class="panel">
<h2>TESTES</h2>

<div class="section">
<h3>Teste de Atributo</h3>
<input id="atributo" type="number" min="1" max="20" placeholder="Atributo (1‚Äì20)">
<div class="dado">üé≤</div>
<button onclick="testeAtributo()">ROLAR D20</button>
<div class="resultado" id="resAtributo"></div>

<div class="historico">
<h4>üìú Hist√≥rico</h4>
<ul id="histAtributo"></ul>
</div>
</div>

<div class="section">
<h3>Teste de Sanidade</h3>
<div class="dado">üé≤</div>
<button onclick="testeSanidade()">ROLAR D100</button>
<div class="resultado" id="resSan"></div>

<div class="historico">
<h4>üß† Hist√≥rico</h4>
<ul id="histSan"></ul>
</div>
</div>
</div>

<!-- DIREITA -->
<div class="panel">
<h2>STATUS</h2>

<div class="section">
<h4>Chances de Sobreviv√™ncia</h4>
<div style="display:flex;gap:12px;justify-content:center">
<input type="checkbox" id="vidaChk1">
<input type="checkbox" id="vidaChk2">
<input type="checkbox" id="vidaChk3">
</div>

<hr>

<div style="display:flex;gap:15px;justify-content:center">
<label><input type="checkbox" id="ferido"> ü©∏ Extremamente Ferido</label>
<label><input type="checkbox" id="caido"> ‚ò† Ca√≠do</label>
</div>
</div>

<div class="section">
<h4>Vida</h4>
<p>Atual: <b><span id="vidaAtual">0</span></b></p>
<div class="controls">
<button onclick="alterarVida(-1)">-1</button>
<button onclick="alterarVida(1)">+1</button>
<button onclick="alterarVida(-5)">-5</button>
<button onclick="alterarVida(5)">+5</button>
</div>
</div>

<div class="section">
<h4>Sanidade</h4>
<input id="sanMax" type="number" min="0" placeholder="Sanidade M√°xima">
<p>Atual: <b><span id="sanAtual">0</span></b></p>
<div class="controls">
<button onclick="alterarSan(-1)">-1</button>
<button onclick="alterarSan(1)">+1</button>
<button onclick="alterarSan(-5)">-5</button>
<button onclick="alterarSan(5)">+5</button>
</div>
</div>
</div>

</div>

<div class="panel section">
<h3>üò¥ Sono</h3>
<p><b><span id="sonoAtual">0</span> horas</b></p>
<div class="controls">
<button onclick="alterarSono(-1)">-1</button>
<button onclick="alterarSono(1)">+1</button>
<button onclick="alterarSono(-3)">-3</button>
<button onclick="alterarSono(3)">+3</button>
</div>
</div>

<div class="panel section">
<h3>üí∞ Dinheiro</h3>
<input id="dinheiro" type="number">
</div>

<div class="panel section">
<h3>üß† Traumas</h3>
<textarea id="traumas"></textarea>
</div>

<div class="panel section">
<h3>‚≠ê Vantagens</h3>
<textarea id="vantagens"></textarea>
</div>

<div class="panel section">
<h3>üéí Itens / Acess√≥rios</h3>
<textarea id="itens"></textarea>
</div>

</div>

<script>
/* ========= DADOS ========= */
let vida=0, san=0, sono=0;
let histA=[], histS=[];

/* ========= SOM ========= */
function somDado(){
 const ctx=new (window.AudioContext||webkitAudioContext)();
 let t=ctx.currentTime;
 for(let i=0;i<6;i++){
  const o=ctx.createOscillator(),g=ctx.createGain();
  o.frequency.value=150+Math.random()*300;
  g.gain.setValueAtTime(.12,t);
  g.gain.exponentialRampToValueAtTime(.001,t+.08);
  o.connect(g).connect(ctx.destination);
  o.start(t);o.stop(t+.08);t+=.04;
 }
}

/* ========= TESTES ========= */
function testeAtributo(){
 somDado();
 let att=Math.min(20,Math.max(1,+atributo.value||1));
 atributo.value=att;
 const d=Math.floor(Math.random()*20)+1;
 let r="FALHA",c="F";
 if(d===1){r="FALHA CR√çTICA";}
 else if(d>=att){r="NORMAL";c="N";}
 resAtributo.innerHTML=`üé≤ ${d}<br>üìä Atributo ${att}<br><span class="${c}"><b>${r}</b></span>`;
 histA.unshift(`üé≤ ${d} | Atributo ${att} ‚Üí ${r}`);
 histA=histA.slice(0,6);
 salvar();renderHist();
}

function testeSanidade(){
 somDado();
 const max=Math.max(0,+sanMax.value||0);
 const d=Math.floor(Math.random()*100)+1;
 const ok=d<=max;
 resSan.innerHTML=`üé≤ ${d}<br><b>${ok?"SUCESSO":"FALHA"}</b>`;
 histS.unshift(`üß† ${d} / San M√°x ${max} ‚Üí ${ok?"SUCESSO":"FALHA"}`);
 histS=histS.slice(0,6);
 salvar();renderHist();
}

/* ========= HIST√ìRICO ========= */
function renderHist(){
 histAtributo.innerHTML="";
 histA.forEach((h,i)=>{
  const li=document.createElement("li");
  li.className=i<3?"fade-0":i===3?"fade-1":i===4?"fade-2":"fade-3";
  li.textContent=h;histAtributo.appendChild(li);
 });
 histSan.innerHTML="";
 histS.forEach((h,i)=>{
  const li=document.createElement("li");
  li.className=i<3?"fade-0":i===3?"fade-1":i===4?"fade-2":"fade-3";
  li.textContent=h;histSan.appendChild(li);
 });
}

/* ========= STATUS ========= */
function alterarVida(v){vida=Math.max(0,vida+v);vidaAtual.textContent=vida;salvar()}
function alterarSan(v){san=Math.max(0,san+v);sanAtual.textContent=san;salvar()}
function alterarSono(v){sono=Math.max(0,sono+v);sonoAtual.textContent=sono;salvar()}

ferido.onchange=()=>{if(ferido.checked)caido.checked=false;salvar()}
caido.onchange=()=>{if(caido.checked)ferido.checked=false;salvar()}

/* ========= TEMA ========= */
function toggleTema(){
 document.body.classList.toggle("light");
 salvar();
}

/* ========= STORAGE ========= */
function salvar(){
 localStorage.setItem("noir",JSON.stringify({
  vida,san,sono,
  sanMax:sanMax.value,
  histA,histS,
  checks:[vidaChk1.checked,vidaChk2.checked,vidaChk3.checked],
  ferido:ferido.checked,
  caido:caido.checked,
  dinheiro:dinheiro.value,
  traumas:traumas.value,
  vantagens:vantagens.value,
  itens:itens.value,
  tema:document.body.className
 }));
}
function carregar(){
 const d=JSON.parse(localStorage.getItem("noir"));if(!d)return;
 ({vida,san,sono}=d);
 sanMax.value=d.sanMax||0;
 histA=d.histA||[];histS=d.histS||[];
 [vidaChk1.checked,vidaChk2.checked,vidaChk3.checked]=d.checks||[0,0,0];
 ferido.checked=d.ferido||false;
 caido.checked=d.caido||false;
 dinheiro.value=d.dinheiro||"";
 traumas.value=d.traumas||"";
 vantagens.value=d.vantagens||"";
 itens.value=d.itens||"";
 if(d.tema)document.body.className=d.tema;
 vidaAtual.textContent=vida;
 sanAtual.textContent=san;
 sonoAtual.textContent=sono;
 renderHist();
}
carregar();
</script>

</body>
</html>
